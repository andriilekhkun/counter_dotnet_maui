<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewModels="clr-namespace:Counter_Lekhkun_Andrii.ViewModels"
             x:Class="Counter_Lekhkun_Andrii.Views.AllCountersPage"
             NavigatedTo="ContentPage_NavigateTo"
             Title="All Your Counters">
    <ContentPage.BindingContext>
        <viewModels:CountersViewModel/>
    </ContentPage.BindingContext>
    
    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Add"
                     Command="{Binding GoToAddCommand}"/>
    </ContentPage.ToolbarItems>

    <CollectionView x:Name="countersCollection"
                    ItemsSource="{Binding AllCounters}"
                    Margin="20"
                    SelectionMode="Single"
                    SelectionChangedCommand="{Binding SelectCounterCommand}"
                    SelectionChangedCommandParameter="{Binding x:DataType='CollectionView', Source={RelativeSource Self}, Path=SelectedItem}">
        
        <CollectionView.ItemsLayout>
            <LinearItemsLayout Orientation="Horizontal" ItemSpacing="10"/>
        </CollectionView.ItemsLayout>

        <CollectionView.ItemTemplate>
            <DataTemplate x:DataType="viewModels:CounterViewModel">
                <VerticalStackLayout Padding="20"
                                     Spacing="20"
                                     BackgroundColor="{Binding Color}"
                                     HeightRequest="300">
                    <Label Text="{Binding Name}"
                           HorizontalTextAlignment="Center"
                           FontSize="30"
                           TextColor="Black"/>
                    <Label Text="{Binding Count}"
                           HorizontalTextAlignment="Center"
                           FontSize="50"
                           TextColor="Black"/>
                    <Grid ColumnDefinitions="*,*"
                          ColumnSpacing="30">
                        <Button Grid.Column="0"
                                Text="+"
                                Command="{Binding IncreaseCommand}"
                                WidthRequest="40"
                                HeightRequest="40"/>
                        <Button Grid.Column="1"
                                Text="-"
                                Command="{Binding DecreaseCommand}"
                                WidthRequest="40"
                                HeightRequest="40"/>
                    </Grid>
                    <Button Text="Reset"
                            Command="{Binding ResetCommand}"/>
                </VerticalStackLayout>
            </DataTemplate>
        </CollectionView.ItemTemplate>
    </CollectionView>
</ContentPage>